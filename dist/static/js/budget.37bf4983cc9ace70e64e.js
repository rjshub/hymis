webpackJsonp([2],{"0o98":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("head-fold",{staticStyle:{"margin-top":"20px"},attrs:{title:"STEP4:"+e.$t("lang.budget_step4_title")}},[a("div",{staticClass:"clearfix kpi-predict"},[a("div",{staticClass:"clearfix"},[a("el-select",{staticStyle:{width:"180px","margin-left":"5px"},attrs:{size:"mini",clearable:"",placeholder:e.$t("lang.public_media_type_placeholder")},on:{change:e.onChangeMediaType},model:{value:e.mediaType,callback:function(t){e.mediaType=t},expression:"mediaType"}},e._l(e.slist.typelist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("el-select",{staticStyle:{width:"180px","margin-left":"5px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_media_placeholder")},on:{change:e.onChangeMedia},model:{value:e.media,callback:function(t){e.media=t},expression:"media"}},e._l(e.slist.medialist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-table",{staticStyle:{width:"100%","background-color":"434954"},attrs:{data:e.renderList,"max-height":"400",border:!0}},[a("el-table-column",{attrs:{prop:"media_type",label:e.$t("lang.budget_step4_kpi_table_config.media_type")}}),e._v(" "),a("el-table-column",{attrs:{prop:"media",label:e.$t("lang.budget_step4_kpi_table_config.media")}}),e._v(" "),a("el-table-column",{attrs:{prop:"CPM",label:e.$t("lang.budget_step4_kpi_table_config.CPM")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.twoPoint(t.row.CPM[0]))+"~"+e._s(e.twoPoint(t.row.CPM[1]))+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CPC",label:e.$t("lang.budget_step4_kpi_table_config.CPC")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.twoPoint(t.row.CPC[0]))+"~"+e._s(e.twoPoint(t.row.CPC[1]))+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CPL",label:e.$t("lang.budget_step4_kpi_table_config.CPL")},scopedSlots:e._u([{key:"default",fn:function(t){return["-"!=t.row.CPL[0]&&"-"!=t.row.CPL[1]?[e._v("\n                            "+e._s(e.twoPoint(t.row.CPL[0]))+"~"+e._s(e.twoPoint(t.row.CPL[1]))+"\n                        ")]:[e._v("--")]]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CTR",label:e.$t("lang.budget_step4_kpi_table_config.CTR")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.twoPoint(t.row.CTR[0]))+"~"+e._s(e.twoPoint(t.row.CTR[1]))+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CPUV",label:e.$t("lang.budget_step4_kpi_table_config.CPUV")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.twoPoint(t.row.CPUV[0]))+"~"+e._s(e.twoPoint(t.row.CPUV[1]))+"\n                    ")]}}])})],1)],1)])])},i=[],n={render:r,staticRenderFns:i};t.a=n},"1o0O":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0}}],staticClass:"budget-input-content"},[a("div",{staticClass:"breadcrumb-wrap"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:"/budget/manage"}},[a("span",{staticClass:"breadcrumb-item-line"},[e._v("|")]),e._v(e._s(e.$t("lang.third_nav_budget_list")))]),e._v(" "),a("el-breadcrumb-item",[a("span",{staticClass:"breadcrumb-item-line"}),e._v(e._s("create"===e.handle_type?e.$t("lang.public_add"):e.$t("lang.public_tooltip_edit")))])],1),e._v(" "),2==e.step?a("div",[a("el-button",{attrs:{plain:""},on:{click:e.onBack}},[e._v(e._s(e.$t("lang.public_back")))]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:e.onDownLoad}},[e._v(e._s(e.$t("lang.public_tooltip_download")+e.$t("lang.AS_detail_result")))])],1):e._e()],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step==1"}]},[a("base-info",{ref:"refBaseInfo",attrs:{edit_info:e.edit_form,selectList:e.edit_select},on:{currentPort:e.changeBasePort}}),e._v(" "),a("media-point",{ref:"refMediaPoint",attrs:{RtreeResult:e.RtreeResult,currentPortVal:e.currentPortVal}}),e._v(" "),"create"===e.handle_type?a("el-button",{staticStyle:{"margin-left":"6px"},on:{click:function(t){e.onStartCalculate("new")}}},[e._v(e._s(e.$t("lang.public_Start_calculating")))]):e._e(),e._v(" "),"edit"===e.handle_type?a("el-button",{staticStyle:{"margin-left":"6px"},on:{click:e.view_last_result}},[e._v(e._s(e.$t("lang.public_view_last_result")))]):e._e(),e._v(" "),"edit"===e.handle_type?a("el-button",{staticStyle:{"margin-left":"6px"},on:{click:function(t){e.onStartCalculate("old")}}},[e._v(e._s(e.$t("lang.public_Again_calculating")))]):e._e(),e._v(" "),a("el-button",{staticStyle:{"margin-left":"6px"},on:{click:e.go_back}},[e._v(e._s(e.$t("lang.public_button_cancel")))])],1),e._v(" "),2==e.step?[a("allocate-result",{attrs:{list:e.allocateList,isShowTA:e.isShowTA,total:e.totalData,selectList:e.selectList}}),e._v(" "),a("kpi-predict",{attrs:{list:e.kpiList,selectList:e.selectList}})]:e._e()],2)},i=[],n={render:r,staticRenderFns:i};t.a=n},"2nG1":function(e,t,a){"use strict";var r=a("M4fF"),i=a.n(r),n=a("PJh5"),o=(a.n(n),a("7B+g"),a("PZ87"));t.a={name:"allocate-result",components:{headFold:o.a},props:{list:{type:Array,required:!0},total:{type:Object,required:!0},selectList:{type:Object,required:!0},isShowTA:{type:Boolean,required:!0}},data:function(){return{slist:{},mediaType:"",media:"",point:""}},watch:{},computed:{renderList:function(){var e=this,t=i.a.cloneDeep(this.list);if(""==this.mediaType&&""==this.media&&""==this.point){var a={media_type:"total",media:this.total.media_lens,position:this.total.site_lens,uv:this.total.total_equipment,ta:this.total.total_ta,price:this.total.total_price,days:this.total.total_days,win:this.total.total_win};t.push(a)}else this.mediaType&&(t=t.filter(function(t){return t.media_type_id==e.mediaType})),this.media&&(t=t.filter(function(t){return t.media_id==e.media})),this.point&&(t=t.filter(function(t){return t.position_id==e.point}));return t}},created:function(){this.slist=this.selectList},mounted:function(){},methods:{setRowClass:function(e){e.row;if(e.rowIndex==this.renderList.length-1&&""==this.mediaType&&""==this.media&&""==this.point)return"row-last"},onChangeMediaType:function(){},onChangeMedia:function(){},onChangePoint:function(){},sendEvent:function(){this.$eventHub.$emit("ALLOCATE-RESULT",{mediaType:this.mediaType,media:this.media,point:this.point})}}}},"3AmV":function(e,t,a){var r=a("ajS7");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("4a5ae5ca",r,!0)},"41h9":function(e,t,a){var r=a("pEl1");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("d264cf34",r,!0)},"5PlU":function(e,t,a){var r=a("RY/4"),i=a("dSzd")("iterator"),n=a("/bQp");e.exports=a("FeBl").isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||n.hasOwnProperty(r(t))}},"6Jw+":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".base-info[data-v-203884e4]{margin-top:30px}.base-info .crowd-box[data-v-203884e4]{background-color:#212936;border:1px dashed #59616c;width:940px;height:118px;padding:16px 18px}.base-info .crowd-box .crowd-title[data-v-203884e4]{font-size:12px;color:#fff}.base-info .target-val[data-v-203884e4]{display:inline-block}.base-info .target-icon[data-v-203884e4]{color:#fff;display:inline-block;width:10px}.base-info .target-start[data-v-203884e4]{display:inline-block;width:127px;margin-left:6px}.base-info .target-end[data-v-203884e4]{display:inline-block;width:127px}.base-info .port-target-tip[data-v-203884e4]{position:absolute;left:-2px;font-size:12px;line-height:12px;top:30px;color:orange}",""])},"8rY8":function(e,t,a){var r=a("n7Gd");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("546f873d",r,!0)},FDW9:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("head-fold",{attrs:{title:"STEP3:"+e.$t("lang.budget_step3_title")}},[a("div",{staticClass:"clearfix allocate-result"},[a("div",{staticClass:"clearfix"},[a("el-select",{staticStyle:{width:"180px","margin-left":"5px"},attrs:{size:"mini",clearable:"",placeholder:e.$t("lang.public_media_type_placeholder")},on:{change:e.onChangeMediaType},model:{value:e.mediaType,callback:function(t){e.mediaType=t},expression:"mediaType"}},e._l(e.slist.typelist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("el-select",{staticStyle:{width:"180px","margin-left":"5px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_media_placeholder")},on:{change:e.onChangeMedia},model:{value:e.media,callback:function(t){e.media=t},expression:"media"}},e._l(e.slist.medialist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("el-select",{staticStyle:{width:"180px","margin-left":"5px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_position_placeholder")},on:{change:e.onChangePoint},model:{value:e.point,callback:function(t){e.point=t},expression:"point"}},e._l(e.slist.positionlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-table",{staticStyle:{width:"100%","background-color":"#434954"},attrs:{data:e.renderList,"max-height":"200","row-class-name":e.setRowClass,border:!0}},[a("el-table-column",{attrs:{prop:"media_type",label:e.$t("lang.budget_step3_result_table_config.media_type")}}),e._v(" "),a("el-table-column",{attrs:{prop:"media",label:e.$t("lang.budget_step3_result_table_config.media")}}),e._v(" "),a("el-table-column",{attrs:{prop:"position",label:e.$t("lang.budget_step3_result_table_config.position")}}),e._v(" "),a("el-table-column",{attrs:{prop:"uv",label:e.$t("lang.budget_step3_result_table_config.uv")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n           "+e._s(e.$formatNumber(t.row.uv,0,""))+"\n        ")]}}])}),e._v(" "),e.isShowTA?a("el-table-column",{attrs:{prop:"ta",label:"TA%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n           "+e._s(e.$formatNumber(t.row.ta,2,""))+"\n        ")]}}])}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"win",label:e.$t("lang.budget_step3_result_table_config.win")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n           "+e._s(e.$formatNumber(t.row.win,0,""))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:e.$t("lang.budget_step3_result_table_config.price")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n           "+e._s(e.$formatNumber(t.row.price,2,""))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"days",label:e.$t("lang.budget_step3_result_table_config.days")},scopedSlots:e._u([{key:"default",fn:function(t){return["-"==t.row.days?a("span",[e._v("\n            "+e._s(t.row.days)+"\n          ")]):a("span",[e._v("\n             "+e._s(e.$formatNumber(t.row.days,0,""))+"\n          ")])]}}])})],1)],1)])])},i=[],n={render:r,staticRenderFns:i};t.a=n},J6Au:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".base-info .el-form--inline .age-box .el-tag{cursor:pointer;margin-right:10px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.base-info .el-form--inline .age-box .el-tag.active{background-color:#39af97;color:#fff}.base-info .el-form--inline .el-form-item.form-item-even,.base-info .el-form--inline .el-form-item:nth-child(2n){padding-left:50px}.base-info .el-form--inline .el-form-item.form-item-odd{padding-left:0}.base-info .el-form--inline .el-form-item.form-item-odd .el-form-item__label{width:120px}.base-info .el-form--inline .el-form-item{margin-bottom:20px}.base-info .el-form--inline .el-input-group__append{padding:0 10px}.base-info .el-form--inline .el-form-item.target-func{padding-left:0}.base-info .el-form--inline .el-form-item.target-func .el-form-item__label{width:81px!important}",""])},JHVs:function(e,t,a){var r=a("ynx3");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("0217f818",r,!0)},Jxqw:function(e,t,a){"use strict";function r(e){a("iWHT"),a("ci7h")}var i=a("pUO3"),n=a("Vtki"),o=a("VU/8"),l=r,s=o(i.a,n.a,!1,l,"data-v-203884e4",null);t.a=s.exports},"KLG/":function(e,t,a){var r=a("SzOm");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("5f8f846e",r,!0)},LYOG:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".kpi-predict .el-table .el-table__row.row-last .cell{color:#b2b4b9;font-weight:800;font-size:14px}",""])},LkAb:function(e,t,a){"use strict";var r=a("M4fF");a.n(r);t.a={name:"head-fold",components:{},props:{title:{type:String,required:!0}},data:function(){return{isShow:!0}},watch:{},computed:{},created:function(){},mounted:function(){},methods:{onToggle:function(){this.isShow=!this.isShow}}}},Ln20:function(e,t,a){"use strict";function r(e){a("3AmV"),a("Re1d")}var i=a("2nG1"),n=a("FDW9"),o=a("VU/8"),l=r,s=o(i.a,n.a,!1,l,"data-v-24e01591",null);t.a=s.exports},MumK:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".budget-input-content .hy-input-with-title .el-input--prefix .el-input__inner{padding-left:50px}.operatelog-popover .el-table{max-height:600px;overflow:auto}",""])},OWTv:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head-fold-area"},[a("div",{staticClass:"head"},[a("div",{staticClass:"title",on:{click:e.onToggle}},[e._v(e._s(e.title)+"\n      "),a("transition",{attrs:{name:"el-zoom-in-center"}},[e.isShow?a("i",{staticClass:"el-icon-arrow-up"}):a("i",{staticClass:"el-icon-arrow-down"})])],1),e._v(" "),a("div",{staticClass:"line"})]),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"content-box"},[e._t("default")],2)])],1)},i=[],n={render:r,staticRenderFns:i};t.a=n},PO67:function(e,t,a){var r=a("LYOG");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("74398a26",r,!0)},PZ87:function(e,t,a){"use strict";function r(e){a("8rY8"),a("KLG/")}var i=a("LkAb"),n=a("OWTv"),o=a("VU/8"),l=r,s=o(i.a,n.a,!1,l,"data-v-36b006cb",null);t.a=s.exports},R6T3:function(e,t,a){var r=a("zE+F");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("57593c1b",r,!0)},RGti:function(e,t,a){"use strict";var r=a("woOf"),i=a.n(r),n=a("//Fk"),o=a.n(n),l=a("fZjL"),s=a.n(l),c=a("Xxa5"),d=a.n(c),u=a("exGp"),p=a.n(u),f=a("Dd8w"),_=a.n(f),h=a("M4fF"),m=a.n(h),g=a("NYxO"),b=a("PJh5"),v=(a.n(b),a("7B+g")),y=a("Jxqw"),x=a("n2Vb"),w=a("Ln20"),k=a("XuFn");t.a={name:"UserManage",components:{baseInfo:y.a,mediaPoint:x.a,allocateResult:w.a,kpiPredict:k.a},data:function(){return{step:1,isLoading:!1,selectList:{},allocateList:[],kpiList:[],totalData:{},param:{},kpiPredictResult:{},allocateResult:{},currentPortVal:"",isShowTA:!1,edit_form:{gender:"",projectName:"",customer:"",brand:"",product:"",cycle:"",budget:"",targetFunc:"",port:[],target:""},ta_item:[],edit_select:{},RtreeResult:[]}},props:{},created:function(){var e=this;this.$eventHub.$on("KPI-PREDICT",function(t){var a=t.mediaType,r=t.media;e.getKpiPredict({mediaType:a,media:r})}),this.$eventHub.$on("ALLOCATE-RESULT",function(t){var a=t.mediaType,r=t.media,i=t.point;e.getAllocateResult({mediaType:a,media:r,point:i})})},mounted:function(){"edit"===this.handle_type&&this.find_one()},computed:_()({},Object(g.e)("budget",["handle_type","budgetID"])),watch:{},methods:_()({},Object(g.b)("budget",["update_budget_id","update_is_fromback","update_handle_type","update_select_value"]),{find_one:function(){var e=this;return p()(d.a.mark(function t(){var a,r,i,n,o,l,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a="/algorithm/details",r={id:e.budgetID},t.next=4,e.fetchCore(a,r,!0);case 4:i=t.sent,i&&(e.edit_form.projectName=i.project_name,e.edit_form.customer=i.customer_id,e.edit_form.brand=i.brand_id,e.edit_form.product=i.product_id,e.edit_form.cycle=i.days[0],e.edit_form.budget=i.total_price,e.edit_form.targetFunc=i.taper_value,e.edit_form.port=i.port,e.edit_form.target=i.taper_key,i.ta_item&&(n=i.ta_item.includes("sex_male_rate"),o=i.ta_item.includes("sex_female_rate"),n&&o?e.edit_form.gender="0":!n&&o?e.edit_form.gender="sex_female_rate":n&&!o&&(e.edit_form.gender="sex_male_rate"),i.ta_item.forEach(function(t){e.$refs.refBaseInfo.update_ageRange(t)})),i.pos_list&&(l=[],s=[],i.pos_list.forEach(function(e){var t={key:e.key,lowday:e.lowday,upday:e.upday,period_safety:e.period_safety};l.push(e.key),s.push(t)}),e.RtreeResult=s,e.$refs.refMediaPoint.fetchGetTree(l,i.period_safety,e.edit_form.port.join(","))));case 6:case"end":return t.stop()}},t,e)}))()},back:function(){this.$router.replace("/budget/manage")},getKpiPredict:function(e){var t=this,a=e.mediaType,r=e.media;return p()(d.a.mark(function e(){var i,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.getFilterParam({mediaType:a,media:r}),e.next=3,t.fetchCalculate(i);case 3:n=e.sent,t.kpiPredictResult=n.results,t.kpiList=n.results.data.kpi;case 6:case"end":return e.stop()}},e,t)}))()},getAllocateResult:function(e){var t=this,a=e.mediaType,r=e.media,i=e.point;return p()(d.a.mark(function e(){var n,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getFilterParam({mediaType:a,media:r,point:i}),e.next=3,t.fetchCalculate(n);case 3:o=e.sent,t.allocateResult=o.results,t.totalData=o.results.data.data_total,t.allocateList=o.results.data.data;case 7:case"end":return e.stop()}},e,t)}))()},getFilterParam:function(e){var t=e.mediaType,a=e.media,r=e.point,i=m.a.cloneDeep(this.param),n=i.pos_list,o=[];return t&&(o=n.filter(function(e){return e.media_type_id==t})),a&&(o=n.filter(function(e){return e.media_id==a})),r&&(o=n.filter(function(e){return e.position_id==r})),o.length&&(i.pos_list=o),i},fetchCalculate:function(e){var t=this;return p()(d.a.mark(function a(){var r;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.fetchCore("/algorithm/compute",e);case 2:return r=a.sent,m.a.isPlainObject(r.selected)||(r.selected={}),m.a.isPlainObject(r.results)||(r.results={data:{data:[],data_total:{},kpi:[]}}),r.algorithm_id&&t.update_budget_id(r.algorithm_id),m.a.isPlainObject(r.results.data)||(t.$message.error(t.$t("lang.budget_Calculate_fail")),r.results={data:{data:[],data_total:{},kpi:[]}}),a.abrupt("return",r);case 8:case"end":return a.stop()}},a,t)}))()},go_back:function(){this.$router.replace("/budget/manage")},view_last_result:function(){var e=this;return p()(d.a.mark(function t(){var a,r,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a="/algorithm/viewresult",r={id:e.budgetID},t.next=4,e.fetchCore(a,r,!0);case 4:i=t.sent,i&&(i.results.data.data.length&&s()(i.results.data.data[0]).includes("ta")&&(e.isShowTA=!0),e.kpiPredictResult=i.results,e.allocateResult=i.results,e.selectList=i.selected,e.totalData=i.results.data.data_total,e.allocateList=i.results.data.data,e.kpiList=i.results.data.kpi,e.kpiList.length&&e.allocateList.length&&(e.step=2));case 6:case"end":return t.stop()}},t,e)}))()},onStartCalculate:function(e){var t=this,a=[],r=this.$refs.refBaseInfo.onSubmit(),n=this.$refs.refMediaPoint.onSubmit();a.push(r,n),o.a.all(a).then(function(){var a=p()(d.a.mark(function a(r){var n,o;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=i()({},r[0],r[1]),"old"===e&&t.$set(n,"algorithm_id",t.budgetID),t.isShowTA="ta"==r[0].taper_key,t.param=n,a.next=6,t.fetchCalculate(n);case 6:o=a.sent,t.kpiPredictResult=o.results,t.allocateResult=o.results,t.selectList=o.selected,t.totalData=o.results.data.data_total,t.allocateList=o.results.data.data,t.kpiList=o.results.data.kpi,t.kpiList.length&&t.allocateList.length&&(t.step=2);case 14:case"end":return a.stop()}},a,t)}));return function(e){return a.apply(this,arguments)}}()).catch(function(e){})},onBack:function(){"create"===this.handle_type&&this.budgetID&&this.update_handle_type("edit"),this.step=1},onDownLoad:function(){var e=this;return p()(d.a.mark(function t(){var a,r,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a="/algorithm/download",r={id:e.budgetID},t.next=4,e.fetchCore(a,r,!0);case 4:i=t.sent,i&&e.$downloadFile("/api/"+i);case 6:case"end":return t.stop()}},t,e)}))()},changeBasePort:function(e){this.currentPortVal=e},fetchCore:function(e,t){var a=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return p()(d.a.mark(function i(){var n;return d.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r&&(a.isLoading=!0),i.prev=1,i.next=4,v.a.post(e,t);case 4:return n=i.sent,i.abrupt("return",n);case 8:throw i.prev=8,i.t0=i.catch(1),a.$message.error(i.t0.message),i.t0;case 12:return i.prev=12,r&&(a.isLoading=!1),i.finish(12);case 15:case"end":return i.stop()}},i,a,[[1,8,12,15]])}))()}}),beforeRouteLeave:function(e,t,a){"BudgetManage"===e.name&&this.update_is_fromback(!0),this.update_select_value(""),a()}}},Re1d:function(e,t,a){var r=a("dcOj");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("3d7c95d3",r,!0)},RrFX:function(e,t,a){"use strict";var r=a("d7EF"),i=a.n(r),n=a("//Fk"),o=a.n(n),l=a("Xxa5"),s=a.n(l),c=a("exGp"),d=a.n(c),u=a("BO1k"),p=a.n(u),f=a("Dd8w"),_=a.n(f),h=a("NYxO"),m=a("M4fF"),g=a.n(m),b=a("PJh5"),v=(a.n(b),a("7B+g")),y=a("PZ87");t.a={name:"media-point",components:{headFold:y.a},data:function(){return{periodProtect:!1,isLoading:!1,treeKeyWord:"",port:"",props:{label:"name",children:"children"},treeData:[],rtreeData:[],checked_keys:[]}},props:{currentPortVal:{type:String,required:!0},RtreeResult:{type:Array}},watch:{treeKeyWord:function(e){this.$refs.LtreeRef.filter(e)},currentPortVal:function(e){this.port=this.currentPortVal,this.checked_keys=[],this.rtreeData=[],this.fetchGetTree([],!1,this.port)}},computed:_()({},Object(h.e)("budget",["handle_type"])),created:function(){this.fetchGetTree([],!1,this.port)},methods:{filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},onSearch:function(e){this.$refs.LtreeRef.filter(e)},onLock:function(e,t){t.period_safety=0},onUnlock:function(e,t){t.period_safety=1},onRemove:function(e,t){var a=e.parent,r=a.data.children||a.data,i=r.findIndex(function(e){return e.key===t.key});r.splice(i,1),this.$refs.LtreeRef.setChecked(t.key,!1,!0)},handleLeftError:function(){this.isLoading=!1,this.$message.error(this.$t("lang.public_upload_fail"))},handleLeftBeforeUpload:function(){this.isLoading=!0},handleLeftSuccess:function(e,t){if(this.isLoading=!1,e&&0==e.ret){var a=this.getUploadData(e.data);this.setRtreeByUploadData(a),this.$message.success(this.$t("lang.public_upload_success"))}else this.$message.error(e.msg||this.$t("lang.public_upload_fail"))},setRtreeByUploadData:function(e){var t=!0,a=!1,r=void 0;try{for(var i,n=p()(e);!(t=(i=n.next()).done);t=!0){var o=i.value,l=this.getNodeByKey(o.key);g.a.isPlainObject(l)&&(l.customer_cpm=o.customer_cpm,l.discount=o.discount)}}catch(e){a=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw r}}},getNodeByKey:function(e,t){Array.isArray(t)||(t=this.rtreeData);var a=!0,r=!1,i=void 0;try{for(var n,o=p()(t);!(a=(n=o.next()).done);a=!0){var l=n.value;if(l.hasOwnProperty("children")&&0!=l.children.length){var s=this.getNodeByKey(e,l.children);if(s)return s}else if(l.key==e)return l}}catch(e){r=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw i}}},getUploadData:function(e){var t=[],a=!0,r=!1,i=void 0;try{for(var n,o=p()(e);!(a=(n=o.next()).done);a=!0){var l=n.value;l.hasOwnProperty("children")?t=t.concat(this.getUploadData(l.children)):t.push(l)}}catch(e){r=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw i}}return t},onDownLoad:function(){var e=this;return d()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,e.fetchCore("/algorithm/downloadformat",{data:e.rtreeData});case 3:a=t.sent,e.isLoading=!1,e.$downloadFile("/api/"+a);case 6:case"end":return t.stop()}},t,e)}))()},formatTree:function(e,t){var a=[],r=!0,i=!1,n=void 0;try{for(var o,l=p()(e);!(r=(o=l.next()).done);r=!0){var s=o.value;s.customer_cpm=0,s.discount=0,s.period_safety=0,s.hasOwnProperty("children")&&0!=s.children.length||(s.lowday="",s.upday="");var c=s.key.lastIndexOf("_");if(""==t){if(-1==c){var d=g.a.cloneDeep(s);delete d.children,d.children=this.formatTree(e,s.key),a.push(d)}}else{if(s.key.substr(0,c)==t){var u=g.a.cloneDeep(s);delete u.children,u.children=this.formatTree(e,s.key),a.push(u)}}}}catch(e){i=!0,n=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw n}}return a},getKeysByStr:function(e){var t=[e],a=e.lastIndexOf("_");if(-1!=a){var r=e.substr(0,a);t=t.concat(this.getKeysByStr(r))}return t},onChangeCheck:function(e,t,a){var r=this.$refs.LtreeRef.getCheckedNodes(!1,!0);this.rtreeData=this.formatTree(g.a.cloneDeep(r),""),"edit"===this.handle_type&&this.format_edit_Rtree(this.rtreeData)},format_edit_Rtree:function(e){var t=this;e.forEach(function(e){if(e.hasOwnProperty("children")&&0!==e.children.length)t.format_edit_Rtree(e.children);else{var a=t.RtreeResult.findIndex(function(t){return t.key===e.key});-1!==a&&(e.lowday=t.RtreeResult[a].lowday,e.upday=t.RtreeResult[a].upday,e.period_safety=t.RtreeResult[a].period_safety)}})},removeChildren:function(e){var t=!0,a=!1,r=void 0;try{for(var i,n=p()(e);!(t=(i=n.next()).done);t=!0){var o=i.value;o.isLeaf=!o.hasOwnProperty("children"),delete o.children}}catch(e){a=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw r}}},onSubmit:function(){var e=this;return new o.a(function(t,a){e.getData().pos_list.length?t(e.getData()):(e.$message.error(e.$t("lang.public_position_placeholder")),a())})},getData:function(){var e=this.getLeafData(),t=[],a=!0,r=!1,n=void 0;try{for(var o,l=p()(e);!(a=(o=l.next()).done);a=!0){var s=o.value,c=s.key.split("_"),d=i()(c,2),u=d[0],f=d[1],_={position:s.name,position_id:s.id,media:s.media_name,media_id:f,media_type:s.level_1_name,media_type_id:u,lowday:s.lowday,upday:s.upday,period_safety:s.period_safety,customer_cpm:s.customer_cpm,discount:s.discount,ports:s.ports,key:s.key};t.push(_)}}catch(e){r=!0,n=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw n}}return{pos_list:t,period_safety:this.periodProtect?1:0}},getLeafData:function(e){e||(e=this.rtreeData);var t=[],a=!0,r=!1,i=void 0;try{for(var n,o=p()(e);!(a=(n=o.next()).done);a=!0){var l=n.value;0==l.children.length?t.push(l):t=t.concat(this.getLeafData(l.children))}}catch(e){r=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw i}}return t},addUniqueId:function(e){var t=!0,a=!1,r=void 0;try{for(var i,n=p()(e);!(t=(i=n.next()).done);t=!0){var o=i.value;o.key=g.a.uniqueId("p_"),Array.isArray(o.children)&&this.addUniqueId(o.children)}}catch(e){a=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw r}}},fetchGetTree:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2];return d()(s.a.mark(function i(){var n;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.fetchCore("/algorithm/positionlist",{port:r});case 2:n=i.sent,n&&(t.treeData=n,t.checked_keys=e,t.periodProtect="1"===a);case 4:case"end":return i.stop()}},i,t)}))()},fetchCore:function(e,t){var a=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return d()(s.a.mark(function i(){var n;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r&&(a.isLoading=!0),i.prev=1,i.next=4,v.a.post(e,t);case 4:return n=i.sent,i.abrupt("return",n);case 8:throw i.prev=8,i.t0=i.catch(1),a.$message.error(i.t0.message),i.t0;case 12:return i.prev=12,r&&(a.isLoading=!1),i.finish(12);case 15:case"end":return i.stop()}},i,a,[[1,8,12,15]])}))()}}}},SzOm:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"",""])},Vtki:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("head-fold",{attrs:{title:"STEP1:"+e.$t("lang.budget_step1_title")}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"clearfix base-info"},[a("el-form",{ref:"form",staticClass:"form",staticStyle:{height:"100%","margin-bottom":"10px"},attrs:{size:"mini",inline:!0,model:e.form,rules:e.rules,"label-width":"105px"}},[a("el-form-item",{attrs:{label:e.$t("lang.public_project_name")+"：",prop:"projectName"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("lang.public_project_name_placeholder")},model:{value:e.form.projectName,callback:function(t){e.$set(e.form,"projectName","string"==typeof t?t.trim():t)},expression:"form.projectName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("lang.public_client_label")+"：",prop:"customer"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_client_placeholder")},on:{change:e.onChangeCustomer},model:{value:e.form.customer,callback:function(t){e.$set(e.form,"customer",t)},expression:"form.customer"}},e._l(e.customer_list,function(e){return a("el-option",{key:e.id,attrs:{label:e.customer_name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("lang.public_period_label")+"：",prop:"cycle"}},[a("el-date-picker",{staticStyle:{width:"400px"},attrs:{size:"mini","prefix-icon":"el-icon-time",type:"daterange",align:"right",clearable:!0,"unlink-panels":"","range-separator":e.$t("lang.public_DatePicker_between"),"start-placeholder":e.$t("lang.public_DatePicker_start"),"end-placeholder":e.$t("lang.public_DatePicker_end"),"value-format":"yyyy-MM-dd"},model:{value:e.form.cycle,callback:function(t){e.$set(e.form,"cycle",t)},expression:"form.cycle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("lang.public_brand_label")+"：",prop:"brand"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_brand_placeholder")},on:{change:e.onChangeBrand},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},e._l(e.brand_list,function(e){return a("el-option",{key:e.id,attrs:{label:e.brand_name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("lang.public_budget_label")+"：",prop:"budget"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("lang.public_budget_placeholder")},model:{value:e.form.budget,callback:function(t){e.$set(e.form,"budget",t)},expression:"form.budget"}},[a("template",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("lang.AS_detail_basic_info_money_unit")))])],2)],1),e._v(" "),a("el-form-item",{staticClass:"form-item-even",attrs:{label:e.$t("lang.public_product_label")+"：",prop:"product"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_product_placeholder")},on:{change:e.onChangeProduct},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e.product_list,function(e){return a("el-option",{key:e.id,attrs:{label:e.product_name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticStyle:{position:"relative"},attrs:{label:e.$t("lang.public_port_label")+"：",prop:"port"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{size:"mini",multiple:"",clearable:"",placeholder:e.$t("lang.public_port_placeholder")},on:{change:e.onChangePort},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},e._l(e.port_list,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),e._v(" "),e.isShowTip?a("div",{staticClass:"port-target-tip"},[e._v(e._s(e.$t("lang.budget_port_change_fail")))]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("lang.public_target_label")+"：",prop:"target"}},[e.isShowTargetTa?a("el-select",{staticStyle:{width:"190px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_target_placeholder")},on:{change:e.onChangeTarget},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}},e._l(e.target_mobile_list,function(e,t){return a("el-option",{key:t,attrs:{label:e.lable,value:e.value}})})):a("el-select",{staticStyle:{width:"190px"},attrs:{size:"mini",filterable:"",clearable:"",placeholder:e.$t("lang.public_target_placeholder")},on:{change:e.onChangeTarget},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}},e._l(e.target_list,function(e,t){return a("el-option",{key:t,attrs:{label:e.lable,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"targetFunc"}},[e.isShowTargetInput||"ctr"==e.form.target?a("el-input",{staticStyle:{width:"197px"},attrs:{placeholder:e.target_input_text()},model:{value:e.form.targetFunc,callback:function(t){e.$set(e.form,"targetFunc","string"==typeof t?t.trim():t)},expression:"form.targetFunc"}},[a("template",{attrs:{slot:"append"},slot:"append"},[e._v("%")])],2):a("el-input",{staticStyle:{width:"197px"},attrs:{placeholder:e.target_input_text()},model:{value:e.form.targetFunc,callback:function(t){e.$set(e.form,"targetFunc","string"==typeof t?t.trim():t)},expression:"form.targetFunc"}})],1),e._v(" "),e.isShowTargetInput?a("el-form-item",{staticClass:"form-item-odd",attrs:{label:e.$t("lang.public_target_audience_label")+"：","label-width":"120px",prop:"targetPopulation"}},[a("div",{staticClass:"crowd-box"},[a("div",{staticClass:"crowd-title"},[e._v(e._s(e.$t("lang.public_gender")))]),e._v(" "),a("el-radio-group",{model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[a("el-radio",{attrs:{label:"0"}},[e._v(e._s(e.$t("lang.public_all")))]),e._v(" "),a("el-radio",{attrs:{label:"sex_male_rate"}},[e._v(e._s(e.$t("lang.public_male")))]),e._v(" "),a("el-radio",{attrs:{label:"sex_female_rate"}},[e._v(e._s(e.$t("lang.public_female")))])],1),e._v(" "),a("div",{staticClass:"crowd-title"},[e._v(e._s(e.$t("lang.public_age")))]),e._v(" "),a("div",{staticClass:"age-box"},e._l(e.ageRange,function(t,r){return a("el-tag",{key:r,class:{active:t.checked},attrs:{size:"small",type:"info"},nativeOn:{click:function(a){e.onClickAge(t)}}},[e._v(e._s(t.name))])}))],1)]):e._e()],1)],1)])},i=[],n={render:r,staticRenderFns:i};t.a=n},Xd32:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("5PlU")},XuFn:function(e,t,a){"use strict";function r(e){a("R6T3"),a("PO67")}var i=a("oKg+"),n=a("0o98"),o=a("VU/8"),l=r,s=o(i.a,n.a,!1,l,"data-v-e08afdd8",null);t.a=s.exports},ajS7:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".allocate-result[data-v-24e01591]{margin-top:30px}",""])},ci7h:function(e,t,a){var r=a("J6Au");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("72ea85ca",r,!0)},d7EF:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=a("us/S"),n=r(i),o=a("BO1k"),l=r(o);t.default=function(){function e(e,t){var a=[],r=!0,i=!1,n=void 0;try{for(var o,s=(0,l.default)(e);!(r=(o=s.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){i=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw n}}return a}return function(t,a){if(Array.isArray(t))return t;if((0,n.default)(Object(t)))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},dcOj:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".allocate-result .el-table .el-table__row.row-last .cell{color:#b2b4b9;font-weight:800;font-size:14px}",""])},"h1+s":function(e,t,a){var r=a("wIcF");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("4f86b850",r,!0)},h4tB:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("head-fold",{attrs:{title:"STEP2:"+e.$t("lang.budget_step2_title")}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"clearfix wrap"},[a("div",{staticClass:"head"},[a("el-upload",{attrs:{action:"/api/algorithm/importformat","show-file-list":!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel","on-error":e.handleLeftError,"before-upload":e.handleLeftBeforeUpload,"on-success":e.handleLeftSuccess}},[a("el-button",{attrs:{plain:""}},[e._v(e._s(e.$t("lang.budget_upload_position_table")))])],1),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:e.onDownLoad}},[e._v(e._s(e.$t("lang.budget_download_position_format_table")))])],1),e._v(" "),a("div",{staticClass:"tree-wrap"},[a("div",{staticClass:"left item"},[a("div",{staticClass:"thead"},[a("span",[e._v(e._s(e.$t("lang.budget_step2_title")))]),e._v(" "),a("el-input",{staticStyle:{width:"193px","vertical-align":"bottom"},attrs:{size:"mini",placeholder:e.$t("lang.public_key_words")},model:{value:e.treeKeyWord,callback:function(t){e.treeKeyWord=t},expression:"treeKeyWord"}},[a("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},slot:"suffix"})])],1),e._v(" "),a("div",{staticClass:"tbody"},[a("el-tree",{ref:"LtreeRef",attrs:{"filter-node-method":e.filterNode,props:e.props,data:e.treeData,"node-key":"key","show-checkbox":"","default-checked-keys":e.checked_keys},on:{"check-change":e.onChangeCheck}})],1)]),e._v(" "),a("div",{staticClass:"right item"},[a("div",{staticClass:"thead"},[a("span",[e._v(e._s(e.$t("lang.public_selected")))]),e._v(" "),a("div",[a("el-checkbox",{model:{value:e.periodProtect,callback:function(t){e.periodProtect=t},expression:"periodProtect"}},[e._v(e._s(e.$t("lang.budget_Start_Period_protection")))])],1)]),e._v(" "),a("div",{staticClass:"tbody"},[a("el-tree",{staticClass:"right-tree",attrs:{props:e.props,data:e.rtreeData,"node-key":"key","default-expand-all":!0,"expand-on-click-node":!1},on:{"check-change":e.onChangeCheck},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"tree-node",attrs:{title:i.name}},[e._v(e._s(i.name))]),e._v(" "),a("span",{staticClass:"ico-box"},[0==i.children.length?a("div",{staticClass:"input-box"},[a("el-input",{staticStyle:{width:"55px"},attrs:{size:"mini",placeholder:e.$t("lang.public_minimum_placeholder")},model:{value:i.lowday,callback:function(t){e.$set(i,"lowday",t)},expression:"data.lowday"}}),e._v("\n                                    "+e._s(e.$t("lang.public_DatePicker_between"))+"\n                                    "),a("el-input",{staticStyle:{width:"55px"},attrs:{size:"mini",placeholder:e.$t("lang.public_maximum_placeholder")},model:{value:i.upday,callback:function(t){e.$set(i,"upday",t)},expression:"data.upday"}})],1):e._e(),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:1==i.period_safety,expression:"data.period_safety==1"}],staticClass:"iconfont icon-lock",on:{click:function(){return e.onLock(r,i)}}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:0==i.period_safety,expression:"data.period_safety==0"}],staticClass:"iconfont icon-unlock",on:{click:function(){return e.onUnlock(r,i)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-trash",on:{click:function(){return e.onRemove(r,i)}}})])])}}])})],1)])])])])},i=[],n={render:r,staticRenderFns:i};t.a=n},iWHT:function(e,t,a){var r=a("6Jw+");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("42935579",r,!0)},ivRK:function(e,t,a){"use strict";function r(e){a("h1+s"),a("sJDa")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("RGti"),n=a("1o0O"),o=a("VU/8"),l=r,s=o(i.a,n.a,!1,l,"data-v-269bfe36",null);t.default=s.exports},n2Vb:function(e,t,a){"use strict";function r(e){a("JHVs"),a("41h9")}var i=a("RrFX"),n=a("h4tB"),o=a("VU/8"),l=r,s=o(i.a,n.a,!1,l,"data-v-0b2e584b",null);t.a=s.exports},n7Gd:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".head-fold-area .head[data-v-36b006cb]{position:relative}.head-fold-area .head .title[data-v-36b006cb]{height:28px;line-height:28px;background:#424852;text-align:center;color:#a6a9ae;cursor:pointer;display:inline-block;padding:0 7px 0 10px}.head-fold-area .head .line[data-v-36b006cb]{height:1px;border-top:1px solid #2b323d;background:#424852}",""])},"oKg+":function(e,t,a){"use strict";var r=a("M4fF"),i=a.n(r),n=a("PJh5"),o=(a.n(n),a("7B+g"),a("PZ87"));t.a={name:"kpi-predict",components:{headFold:o.a},props:{list:{type:Array,required:!0},selectList:{type:Object,required:!0}},data:function(){return{slist:{},mediaType:"",media:""}},watch:{},computed:{renderList:function(){var e=this,t=i.a.cloneDeep(this.list);return this.mediaType&&(t=t.filter(function(t){return t.media_type_id==e.mediaType})),this.media&&(t=t.filter(function(t){return t.media_id==e.media})),t}},created:function(){this.slist=this.selectList},mounted:function(){},methods:{twoPoint:function(e){return this.$formatNumber(e,2,"")},onChangeMediaType:function(){},onChangeMedia:function(){},sendEvent:function(){this.$eventHub.$emit("KPI-PREDICT",{mediaType:this.mediaType,media:this.media})}}}},pEl1:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".right-tree{width:575px}.right-tree .custom-tree-node{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.right-tree .custom-tree-node .tree-node{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.right-tree .custom-tree-node .ico-box{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.right-tree .custom-tree-node .ico-box .input-box .el-input--mini .el-input__inner{height:18px;line-height:18px;padding:0 5px;text-align:center}",""])},pUO3:function(e,t,a){"use strict";var r=a("Gu7T"),i=a.n(r),n=a("Xxa5"),o=a.n(n),l=a("exGp"),s=a.n(l),c=a("//Fk"),d=a.n(c),u=a("BO1k"),p=a.n(u),f=a("Dd8w"),_=a.n(f),h=a("M4fF"),m=(a.n(h),a("PJh5")),g=(a.n(m),a("7B+g")),b=a("PZ87"),v=a("NYxO");t.a={name:"base-info",props:{edit_info:{type:Object},selectList:{type:Object}},components:{headFold:b.a},data:function(){var e=this,t=this,a=function(t,a,r){0==a.length?r(new Error(e.$t("lang.public_project_name_placeholder"))):e.$constReg.name2.test(a)?r():r(new Error(e.$t("lang.reg_name_error_msg")))},r=function(t,a,r){"cpuv"==e.form.target?e.$constReg.num23.test(e.form.targetFunc)?r():r(new Error(e.$t("lang.reg_CPUA_error_msg"))):e.$constReg.positiveInt.test(e.form.targetFunc)?r():r(new Error(e.target_error_text()))},i=function(t,a,r){e.$constReg.num4.test(a)?r():r(new Error(e.$t("lang.reg_positive_number_four_decimal")))},n=function(a,r,i){0!=t.checkedAge.length||t.form.gender?(t.form.gender||i(new Error(e.$t("lang.public_audience_placeholder"))),0==t.checkedAge.length&&i(new Error(e.$t("lang.public_age_placeholder"))),i()):i(new Error(e.$t("lang.public_age_gender_placeholder")))};return{ageRange:[{name:this.$t("lang.public_all"),value:"all",checked:!1},{name:this.$t("lang.public_under_19"),value:"age_19_rate",checked:!1},{name:"19-25 "+this.$t("lang.AS_detail_years_old"),value:"age_19_25_rate",checked:!1},{name:"26-30 "+this.$t("lang.AS_detail_years_old"),value:"age_26_30_rate",checked:!1},{name:"31-40 "+this.$t("lang.AS_detail_years_old"),value:"age_31_40_rate",checked:!1},{name:"41-50 "+this.$t("lang.AS_detail_years_old"),value:"age_41_50_rate",checked:!1},{name:this.$t("lang.public_over_50"),value:"age_50_rate",checked:!1}],port_list:["APP","PC","WAP"],target_list:[{lable:"UV"+this.$t("lang.budget_coverage_label"),value:"uv"},{lable:this.$t("lang.budget_exposures_label"),value:"win"},{lable:"Leads",value:"leads"},{lable:"CPM",value:"cpm"},{lable:"CPC",value:"cpc"},{lable:"CPL",value:"cpl"},{lable:"CPUV",value:"cpuv"},{lable:"CTR",value:"ctr"}],target_mobile_list:[{lable:this.$t("lang.budget_ta_percent"),value:"ta"},{lable:"UV"+this.$t("lang.budget_coverage_label"),value:"uv"},{lable:this.$t("lang.budget_exposures_label"),value:"win"},{lable:"Leads",value:"leads"},{lable:"CPM",value:"cpm"},{lable:"CPC",value:"cpc"},{lable:"CPL",value:"cpl"},{lable:"CPUV",value:"cpuv"},{lable:"CTR",value:"ctr"}],brand_list:[],product_list:[],isLoading:!1,rules:{cycle:[{required:!0,message:this.$t("lang.public_project_period_placeholder"),trigger:["change"]}],projectName:[{required:!0,validator:a,trigger:["blur","change"]}],budget:[{required:!0,validator:i,trigger:["blur","change"]}],customer:[{required:!0,message:this.$t("lang.public_client_placeholder"),trigger:"change"}],brand:[{required:!0,message:this.$t("lang.public_brand_placeholder"),trigger:"change"}],product:[{required:!0,message:this.$t("lang.public_product_placeholder"),trigger:"change"}],targetPopulation:[{required:!0,validator:n,trigger:"change"}],port:[{required:!0,message:this.$t("lang.public_port_placeholder"),trigger:"change"}],target:[{required:!0,message:this.$t("lang.public_Goal_placeholder"),trigger:"change"}],targetFunc:[{required:!0,validator:r,trigger:["blur","change"]}]},form:{gender:"",projectName:"",customer:"",brand:"",product:"",cycle:"",budget:"",targetFunc:"",port:[],target:""}}},watch:{},computed:_()({},Object(v.e)("budget",["customerID","customer_list","handle_type","selectValue"]),Object(v.e)("user",["languageInfo"]),{isShowTargetTa:function(){return 1==this.form.port.length&&this.form.port.indexOf("APP")>-1},isShowTargetInput:function(){return this.isShowTargetTa&&"ta"==this.form.target},isShowTip:function(){return this.form.port.length>0&&(this.form.port.indexOf("PC")>-1||this.form.port.indexOf("WAP")>-1)},checkedAge:function(){var e=[],t=["age_19_rate","age_19_25_rate","age_26_30_rate","age_31_40_rate","age_41_50_rate","age_50_rate"];if(-1!=this.ageRange.findIndex(function(e){return e.checked&&"all"==e.value}))e=t;else{var a=!0,r=!1,i=void 0;try{for(var n,o=p()(this.ageRange);!(a=(n=o.next()).done);a=!0){var l=n.value;l.checked&&e.push(l.value)}}catch(e){r=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw i}}}return e},checkedGender:function(){return"0"==this.form.gender?["sex_male_rate","sex_female_rate"]:[this.form.gender]}}),created:function(){},mounted:function(){var e=this;"edit"===this.handle_type&&this.$nextTick(function(){e.set_edit_form(),e.set_select_list()}),"create"===this.handle_type&&this.customerID&&this.set_select_list(),this.form.customer=this.customerID},methods:_()({},Object(v.b)("budget",["fetch_customer_port_list","fetch_brand_list","fetch_product_list"]),{set_edit_form:function(e){this.form=this.edit_info},set_select_list:function(){this.brand_list=this.selectValue.brandlists||[],this.product_list=this.selectValue.productlists||[]},update_ageRange:function(e){this.ageRange.forEach(function(t){t.value===e&&(t.checked=!0)})},onSubmit:function(){var e=this;return new d.a(function(t,a){e.$refs.form.validate(function(){var r=s()(o.a.mark(function r(i){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i?t(e.getData()):a();case 1:case"end":return r.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}())})},getData:function(){return{project_name:this.form.projectName,customer_id:this.form.customer,brand_id:this.form.brand,product_id:this.form.product,total_price:this.form.budget,ta_item:[].concat(i()(this.checkedAge),i()(this.checkedGender)),port:this.form.port.join(","),taper_key:this.form.target,taper_value:this.form.targetFunc,days:[this.form.cycle]}},onClickAge:function(e){e.checked=!e.checked,this.$refs.form.validateField("targetPopulation")},onChangeCustomer:function(){var e=this;return s()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.form.customer){t.next=10;break}return e.isLoading=!0,t.next=4,e.fetch_brand_list({customer_id:e.form.customer});case 4:a=t.sent,r=a.brand_list,e.brand_list=r,e.isLoading=!1,t.next=11;break;case 10:e.brand_list=[];case 11:e.form.brand="",e.form.product="",e.product_list=[];case 14:case"end":return t.stop()}},t,e)}))()},onChangeBrand:function(){var e=this;return s()(o.a.mark(function t(){var a,r,i,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.form.brand){t.next=12;break}return e.isLoading=!0,a=e.form.customer,r=e.form.brand,t.next=6,e.fetch_product_list({customer_id:a,brand_id:r});case 6:i=t.sent,n=i.product_list,e.product_list=n,e.isLoading=!1,t.next=13;break;case 12:e.product_list=[];case 13:e.form.product="";case 14:case"end":return t.stop()}},t,e)}))()},onChangeProduct:function(){},init:function(){},onChangePort:function(){this.form.target="",this.$emit("currentPort",this.form.port.join(","))},onChangeTarget:function(){this.target_input_text(),this.form.gender="",this.ageRange.forEach(function(e){e.checked=!1}),this.form.targetFunc="",this.$refs.form.validateField("targetFunc",function(e){})},target_input_text:function(){this.$t("lang.budget_Maximum_target");return["ta","uv","win","leads","ctr"].includes(this.form.target)?this.$t("lang.budget_Minimum_target"):this.$t("lang.budget_Maximum_target")},target_error_text:function(){this.$t("lang.reg_target_max_positiveInt");return["ta","uv","win","leads","ctr"].includes(this.form.target)?this.$t("lang.reg_target_min_positiveInt"):this.$t("lang.reg_target_max_positiveInt")},fetchCore:function(e,t){var a=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s()(o.a.mark(function i(){var n;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r&&(a.isLoading=!0),i.prev=1,i.next=4,g.a.post(e,t);case 4:return n=i.sent,i.abrupt("return",n);case 8:throw i.prev=8,i.t0=i.catch(1),a.$message.error(i.t0.message),i.t0;case 12:return i.prev=12,r&&(a.isLoading=!1),i.finish(12);case 15:case"end":return i.stop()}},i,a,[[1,8,12,15]])}))()}})}},sJDa:function(e,t,a){var r=a("MumK");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("5e13259c",r,!0)},"us/S":function(e,t,a){e.exports={default:a("Xd32"),__esModule:!0}},wIcF:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".budget-input-content[data-v-269bfe36]{margin-right:20px;margin-left:20px}.breadcrumb-wrap[data-v-269bfe36]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.operate i[data-v-269bfe36]{margin-left:20px;margin-top:12px;cursor:pointer;opacity:.6;display:inline-block;color:#fff;font-size:30px;width:24px;height:24px;line-height:12px}.operate i[data-v-269bfe36]:hover{opacity:.8}.detail-ico[data-v-269bfe36]{font-size:18px}",""])},ynx3:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".wrap[data-v-0b2e584b]{padding:20px 6px}.wrap .icon-lock[data-v-0b2e584b],.wrap .icon-unlock[data-v-0b2e584b]{margin:0 5px}.wrap .icon-lock[data-v-0b2e584b],.wrap .icon-trash[data-v-0b2e584b],.wrap .icon-unlock[data-v-0b2e584b]{opacity:.5}.wrap .icon-lock[data-v-0b2e584b]:hover,.wrap .icon-trash[data-v-0b2e584b]:hover,.wrap .icon-unlock[data-v-0b2e584b]:hover{opacity:.8}.wrap .icon-trash[data-v-0b2e584b]{font-size:16px;color:#fff}.wrap .head[data-v-0b2e584b]{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:10px}.wrap .head[data-v-0b2e584b],.wrap .tree-wrap[data-v-0b2e584b]{display:-webkit-box;display:-ms-flexbox;display:flex}.wrap .tree-wrap .item[data-v-0b2e584b]{-webkit-box-flex:1;-ms-flex:1;flex:1}.wrap .tree-wrap .item.left[data-v-0b2e584b]{border-right:1px solid #363d47}.wrap .tree-wrap .item .thead[data-v-0b2e584b]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:40px;background-color:#49505a;color:#b5b8bd;padding:0 12px}.wrap .tree-wrap .item .tbody[data-v-0b2e584b]{background-color:#2c323e;padding:12px;height:460px;overflow:auto}",""])},"zE+F":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".kpi-predict[data-v-e08afdd8]{margin-top:30px}",""])}});